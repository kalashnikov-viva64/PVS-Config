<cruisecontrol xmlns:cb="urn:ccnet.config.builder">
	<cb:define name="template_of_PVS_Analyse">
		<project name="$(PVS_ProjectName)" queuePriority="2" queue="Q1">
			<triggers>
				<cb:ifdef name="PVS_ScheduleTime">
					<scheduleTrigger time="$(PVS_ScheduleTime)" buildCondition="ForceBuild" name="AnalyzeNightBuild" />
				</cb:ifdef>
			</triggers>
			<labeller type="dateLabeller" />
			<tasks>
				<exec>
					<description>SvnUpdate.bat</description>
					<executable>C:\PVS-Config\CC.Net\SvnUpdate.bat</executable>
					<buildArgs></buildArgs>
					<baseDirectory>C:\</baseDirectory>
					<buildTimeoutSeconds>10800</buildTimeoutSeconds>
					<successExitCodes>0</successExitCodes>
				</exec>
				<exec>
					<description>PrepareWorkspace.bat</description>
					<executable>C:\PVS-Config\CC.Net\PrepareWorkspace.bat</executable>
					<buildArgs>$(PVS_Platform) $(PVS_IncrediBuild)</buildArgs>
					<baseDirectory>C:\</baseDirectory>
					<buildTimeoutSeconds>1800</buildTimeoutSeconds>
					<successExitCodes>0</successExitCodes>
				</exec>
				<exec>
					<description>Analyse.bat</description>
					<executable>C:\PVS-Config\CC.Net\Analyse.bat</executable>
					<buildArgs>$(PVS_Platform) $(PVS_IncrediBuild) "$(PVS_RootFolder)\temp"</buildArgs>
					<baseDirectory>C:\</baseDirectory>
					<buildTimeoutSeconds>72000</buildTimeoutSeconds>
					<successExitCodes>0</successExitCodes>
				</exec>
			</tasks>
			<publishers>
				<exec>
					<description>PublishingResults.bat</description>
					<executable>C:\PVS-Config\CC.Net\PublishingResults.bat</executable>
					<buildArgs>$(PVS_Platform) "$(PVS_RootFolder)\temp"</buildArgs>
					<baseDirectory>C:\</baseDirectory>
					<buildTimeoutSeconds>14400</buildTimeoutSeconds>
				</exec>
				<merge>
					<files>
						<file>$(PVS_RootFolder)\temp\$(PVS_PlogFile)_totals.txt</file>
						<file>$(PVS_RootFolder)\temp\$(PVS_PlogFile).txt</file>
					</files>
				</merge>
				<xmllogger />
				<exec>
					<description>ClearWorkspace.bat</description>
					<executable>C:\PVS-Config\CC.Net\ClearWorkspace.bat</executable>
					<buildArgs>$(PVS_Platform)</buildArgs>
					<baseDirectory>C:\</baseDirectory>
					<buildTimeoutSeconds>1800</buildTimeoutSeconds>
				</exec>
				<buildpublisher>
					<sourceDir>$(PVS_RootFolder)\temp</sourceDir>
					<publishDir>$(PVS_RootFolder)</publishDir>
					<useLabelSubDirectory>true</useLabelSubDirectory>
					<alwaysPublish>true</alwaysPublish>
				</buildpublisher>
				<exec>
					<executable>C:\Windows\System32\cmd.exe</executable>
					<description>delete temp folder</description>
					<buildArgs>/c del /Q temp</buildArgs>
					<baseDirectory>$(PVS_RootFolder)</baseDirectory>
					<buildTimeoutSeconds>300</buildTimeoutSeconds>
				</exec>
			</publishers>
		</project>
	</cb:define>
	
	<cb:scope
		PVS_ProjectName="PVS-Studio Analysis x86 trunk"
		PVS_ScheduleTime="18:30"
		PVS_Platform="x86"
		PVS_IncrediBuild="UseIB"
		PVS_RootFolder="C:\PVS Dalet logs x86 trunk"
		PVS_PlogFile="generated-x86-projects.plog" >

		<cb:template_of_PVS_Analyse/>
	</cb:scope>
	
	<cb:scope
		PVS_ProjectName="PVS-Studio Analysis x64 trunk"
		PVS_ScheduleTime="22:00"
		PVS_Platform="x64"
		PVS_IncrediBuild="UseIB"
		PVS_RootFolder="C:\PVS Dalet logs x64 trunk"
		PVS_PlogFile="generated-x64-projects.plog" >

		<cb:template_of_PVS_Analyse/>
	</cb:scope>

	<!-- Need to review -->
	<project name="PVS-Studio Amberfin x64" queuePriority="2" queue="Q1">
		<triggers>
			<!--scheduleTrigger time="22:00" buildCondition="ForceBuild" name="AnalyzeNightBuild" /-->
		</triggers>
		<labeller type="dateLabeller" />
		<cb:scope
			PVS_Platform="Amberfin_x64"
			PVS_IncrediBuild="NotUseIB"
			PVS_RootFolder="C:\PVS_Amberfin_x64"
			PVS_Folder="C:\PVS_Amberfin_x64\temp"
			PVS_PlogFile="PVS_Amberfin_x64.plog" >
			<tasks>
				<!--exec>
					<description>SvnUpdate.bat</description>
					<executable>C:\PVS-Config\CC.Net\SvnUpdate.bat</executable>
					<buildArgs></buildArgs>
					<baseDirectory>C:\</baseDirectory>
					<buildTimeoutSeconds>10800</buildTimeoutSeconds>
					<successExitCodes>0</successExitCodes>
				</exec-->
				<!--exec>
					<description>PrepareWorkspace.bat</description>
					<executable>C:\PVS-Config\CC.Net\PrepareWorkspace.bat</executable>
					<buildArgs>x64 NotUseIB</buildArgs>
					<baseDirectory>C:\</baseDirectory>
					<buildTimeoutSeconds>1800</buildTimeoutSeconds>
					<successExitCodes>0</successExitCodes>
				</exec-->
				<exec>
					<description>Analyse.bat</description>
					<executable>C:\PVS-Config\CC.Net\Analyse.bat</executable>
					<buildArgs>$(PVS_Platform) $(PVS_IncrediBuild) "$(PVS_Folder)"</buildArgs>
					<baseDirectory>C:\</baseDirectory>
					<buildTimeoutSeconds>72000</buildTimeoutSeconds>
					<successExitCodes>0</successExitCodes>
				</exec>
			</tasks>		
			<publishers>
				<exec>
					<description>PublishingResults.bat</description>
					<executable>C:\PVS-Config\CC.Net\PublishingResults.bat</executable>
					<buildArgs>$(PVS_Platform) "$(PVS_Folder)"</buildArgs>
					<baseDirectory>C:\</baseDirectory>
					<buildTimeoutSeconds>1800</buildTimeoutSeconds>
				</exec>
				<merge>
					<files>
						<file>$(PVS_RootFolder)\$(PVS_PlogFile)_totals.txt</file>
						<file>$(PVS_RootFolder)\$(PVS_PlogFile).txt</file>
					</files>
				</merge>
				<xmllogger />
				<!--exec>
					<description>ClearWorkspace.bat</description>
					<executable>C:\PVS-Config\CC.Net\ClearWorkspace.bat</executable>
					<buildArgs>x64</buildArgs>
					<baseDirectory>C:\</baseDirectory>
					<buildTimeoutSeconds>1800</buildTimeoutSeconds>
				</exec-->
				<buildpublisher>
					<sourceDir>$(PVS_Folder)</sourceDir>
					<publishDir>$(PVS_RootFolder)</publishDir>
					<useLabelSubDirectory>true</useLabelSubDirectory>
					<alwaysPublish>true</alwaysPublish>
				</buildpublisher>
				<exec>
					<executable>C:\Windows\System32\cmd.exe</executable>
					<description>delete temp folder</description>
					<buildArgs>/c del /Q temp</buildArgs>
					<baseDirectory>"$(PVS_RootFolder)"</baseDirectory>
					<buildTimeoutSeconds>300</buildTimeoutSeconds>
				</exec>
			</publishers>
		</cb:scope>
	</project>
	
</cruisecontrol>
